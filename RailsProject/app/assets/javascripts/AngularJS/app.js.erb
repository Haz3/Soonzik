SoonzikApp = angular.module('SoonzikApp', ['ngRoute', 'ngCookies', 'ngResource', 'ngFileUpload', 'ngAnimate']);


SoonzikApp.config(['$routeProvider', '$locationProvider', '$httpProvider', function($routeProvider, $locationProvider, $httpProvider) {
	var url = document.location.pathname;

	var whitelist = [
		/\/users\/[0-9]+\/finish_signup/,
		/\/users\/sign_in/,
		/\/users\/sign_up/,
		/\/users\/password\/new/
	];

	var dynamicPage = true;
	for (var index in whitelist) {
		if (whitelist[index].test(url) == true) {
			dynamicPage = false;
			break;
		}
	}

	if (dynamicPage) {
  	$locationProvider.html5Mode(true);
    $routeProvider.when('/', {
      templateUrl: '<%= asset_path("AngularJS/views/others/index.html.haml") %>',
      controller: 'IndexCtrl'
    }).when('/users/:id', {
      templateUrl: '<%= asset_path("AngularJS/views/users/show.html.haml") %>',
      controller: 'UsersCtrl'
    }).when('/users/:id/edit', {
      templateUrl: '<%= asset_path("AngularJS/views/users/edit.html.haml") %>',
      controller: 'UsersCtrl'
    }).when('/battles', {
      templateUrl: '<%= asset_path("AngularJS/views/battles/index.html.haml") %>',
      controller: 'BattlesCtrl'
    }).when('/battles/:id', {
      templateUrl: '<%= asset_path("AngularJS/views/battles/show.html.haml") %>',
      controller: 'BattlesCtrl'
    });
  }

  $httpProvider.defaults.useXDomain = true;
	delete $httpProvider.defaults.headers.common["X-Requested-With"];  
}]);