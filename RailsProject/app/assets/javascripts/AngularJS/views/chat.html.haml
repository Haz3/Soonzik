%div{ "ng-controller" => "ChatCtrl", "ng-init" => "chatInit()" }
	.conversation.clearfix{ "ng-style" => "conversationStyle"}
		.miniConversationWindow{ "ng-if" => "miniChat().length > 0" }
			.appendMiniConversationWindow
				%div#miniConvBtn{ "click-outside" => "closeMiniChat()", "ng-click" => "openMiniChat()" }
					%i.fi-comments
					{{ miniChat().length }}
				.dropConv{ "ng-show" => "showMiniWindow.value == true" }
					%ul
						%li{ "ng-repeat" => "miniWindow in miniChat()", "ng-click" => "open_chat(miniWindow.friend)" }
							{{ miniWindow.friend.username }}
							.closeBtn{ "ng-click" => "closeChat(miniWindow)" }
								x
		.conversationWindow{ "ng-repeat" => "friendWindow in onWindows", "ng-if" => "friendWindow.opened == true && friendWindow.maximized == true" }
			.header
				.closeBtn{ "ng-click" => "closeChat(friendWindow)" }
					x
				%span.conversationUsername
					{{friendWindow.friend.username}}
			.content
				.clearfix{ "ng-repeat" => "mess in message[friendWindow.friend.username].messagesText" }
					%p{ "class" => "{{ mess.extern == true ? 'externMessage' : 'myMessage' }}" }
						%span
							{{ mess.value }}
			%input{ "submit-input" => "sendMsg(friendWindow.friend)", "ng-model" => "message[friendWindow.friend.username].value" }
	%p="Connected friends"
	%ul
		%li{ "ng-repeat" => "friend in friends | filter:search:strict", "data-id" => "{{ friend.id }}", "ng-if" => "friend.online == true", "ng-click" => "open_chat(friend)" }
			.online.stateBubble
			%span= "{{ friend.username }}"
	%p="Other friends"
	%ul
		%li{ "ng-repeat" => "friend in friends | filter:search:strict", "data-id" => "{{ friend.id }}", "ng-if" => "friend.online == false", "ng-click" => "open_chat(friend)" }
			.offline.stateBubble
			%span= "{{ friend.username }}"
	%hr
	%input{:type => 'text', :placeholder => 'Search a friend', "ng-model" => "search.username"}