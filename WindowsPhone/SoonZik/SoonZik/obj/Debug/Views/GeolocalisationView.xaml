<Page
    x:Class="SoonZik.Views.GeolocalisationView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:Maps="using:Windows.UI.Xaml.Controls.Maps"
    xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    DataContext="{StaticResource GeolocalisationViewModel}"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>

        <DataTemplate x:Key="ListUserItemTemplate">
            <TextBlock FontSize="25" Text="{Binding username}" />
        </DataTemplate>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="200" />
        </Grid.RowDefinitions>

        <Maps:MapControl x:Name="MyMapControl" Grid.Row="0" Center="{Binding UserLocation.Point, Mode=TwoWay}" ZoomLevel="15">
            <Maps:MapItemsControl ItemsSource="{Binding MapElements}">
                <Maps:MapItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Path Width="18.5" Height="28" Stretch="Fill" Fill="Red"
                              Data="F1 M 36.4167,19C 44.2867,19 50.6667,24.6711 50.6667,31.6667C 50.6667,32.7601 50.5108,33.8212 50.2177,34.8333L 36.4167,57L 22.6156,34.8333C 22.3225,33.8212 22.1667,32.7601 22.1667,31.6667C 22.1667,24.6711 28.5466,19 36.4167,19 Z M 36.4167,27.7083C 34.2305,27.7083 32.4583,29.4805 32.4583,31.6667C 32.4583,33.8528 34.2305,35.625 36.4167,35.625C 38.6028,35.625 40.375,33.8528 40.375,31.6667C 40.375,29.4805 38.6028,27.7083 36.4167,27.7083 Z "
                              Maps:MapControl.Location="{Binding Location}" Maps:MapControl.NormalizedAnchorPoint="0.5,0.5">

                            </Path>

                            <TextBlock Text="{Binding Title}" Foreground="Black" FontSize="10"></TextBlock>

                            <interactivity:Interaction.Behaviors>
                                <core:EventTriggerBehavior EventName="Tapped">
                                    <core:InvokeCommandAction Command="{Binding UserTappedCommand}" />
                                </core:EventTriggerBehavior>
                            </interactivity:Interaction.Behaviors>
                        </Grid>
                    </DataTemplate>
                </Maps:MapItemsControl.ItemTemplate>
            </Maps:MapItemsControl>
        </Maps:MapControl>

        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="60" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="10*" />
                    <ColumnDefinition Width="10*" />
                    <ColumnDefinition Width="10*" />
                    <ColumnDefinition Width="10*" />
                </Grid.ColumnDefinitions>

                <RadioButton Grid.Row="0" Grid.Column="0" Content="2km"
                             IsChecked="{Binding TwoKmActivated, Mode=TwoWay}" Command="{Binding TwoChecked}" />
                <RadioButton Grid.Row="0" Grid.Column="1" Content="5km"
                             IsChecked="{Binding FiveKmActivated, Mode=TwoWay}" Command="{Binding FiveChecked}"/>
                <RadioButton Grid.Row="0" Grid.Column="2" Content="10km"
                             IsChecked="{Binding TenKmActivated, Mode=TwoWay}" Command="{Binding TenChecked}"/>
                <RadioButton Grid.Row="0" Grid.Column="3" Content="20km"
                             IsChecked="{Binding TwentyKmActivated, Mode=TwoWay}" Command="{Binding TwentyChecked}"/>
            </Grid>

            <ListBox Background="Transparent" Grid.Row="1" x:Name="UserListView" ItemsSource="{Binding ListUser}"
                     ItemTemplate="{StaticResource ListUserItemTemplate}"
                     SelectedItem="{Binding UserSelected, Mode=TwoWay}">

                <interactivity:Interaction.Behaviors>
                    <core:EventTriggerBehavior EventName="Tapped">
                        <core:InvokeCommandAction Command="{Binding UserTappedCommand}" />
                    </core:EventTriggerBehavior>
                </interactivity:Interaction.Behaviors>
            </ListBox>
        </Grid>
    </Grid>

</Page>

